<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style type="text/css">	
		#wrap{
			width: 800px;
			height: 400px;
			border:5px solid black;
			position: relative;
		}
		#inner{
			width: 50px;
			height: 50px;
			background-color: red;
			position: absolute;
			left: 0;
			top: 0;
		}
		/*障碍物*/
		#obstacle{
			position: absolute;
			width: 300px;
			height: 200px;
			background-color: blue;
			left: 180px;
			top: 90px;
		}
	</style>
</head>
<body>
	<div id="wrap">
		<!-- 障碍物 -->
		<p id="obstacle"></p>
		<div id="inner"></div>
	</div>
</body>
<script type="text/javascript">
	// 
	var wrap = document.getElementById("wrap");
	var inner = document.getElementById("inner");
	var obstacle = document.getElementById("obstacle");

	// 水平和垂直方向的速度
	var vX = 10;
	var vY = 10;
	// 水平和垂直方向的移动值
	var innerL = 0;
	var innerT = 0;

	setInterval(function(){



		// 一进来的时候，就开始增加
		innerL += vX;
		innerT += vY;

		// 得到inner的四个边
		var innerLeft = innerL;
		var innerTop = innerT;
		var innerRight = innerL + inner.offsetWidth;
		var innerBottom = innerT + inner.offsetHeight;

		// 得到障碍物四个边的值
		var obstacleLeft = obstacle.offsetLeft;
		var obstacleTop = obstacle.offsetTop;
		var obstacleRight = obstacleLeft + obstacle.offsetWidth;
		var obstacleBottom = obstacleTop + obstacle.offsetHeight;


		
		/*
		1. innerRight > obLeft
		2. innerBottom > obTop
		3. innerLeft < obRight
		4. innerTop < obBottom
		*/

		// 判断是否碰到障碍物
		if(innerRight >= obstacleLeft && innerBottom >= obstacleTop && innerLeft <= obstacleRight && innerTop <= obstacleBottom){

			// alert("碰到了")
			// console.log("碰到了");

			// 判断是否碰到障碍物的左边
			if(vX > 0 && Math.abs(innerRight - obstacleLeft) <= vX){
				// -----------------------
				innerL = obstacleLeft - inner.offsetWidth;

				vX = -vX;
			}
			// 判断是否碰到障碍物的上边
			else if(vY > 0 && Math.abs(innerBottom - obstacleTop) <= vY){

				// -----------------------
				innerT = obstacleTop - inner.offsetHeight;

				vY = -vY;
			}
			// 判断是否碰到障碍物的右边
			else if(vX < 0 && Math.abs(innerLeft - obstacleRight) <= Math.abs(vX)){

				// -----------------------
				innerL = obstacleRight;

				vX = -vX;
			}
			// 判断是否碰到障碍物的下边
			else if(vY < 0 && Math.abs(innerTop - obstacleBottom) <= Math.abs(vY)){

				// -----------------------
				innerT = obstacleBottom;

				vY = -vY;
			}
		}

		// 判断是否碰壁
		if(innerLeft < 0 || innerRight > wrap.clientWidth){
			// 判断碰到左边壁
			if(vX < 0){
				innerL = 0;
			}
			// 判断右边壁
			else if(vX > 0){
				innerL = wrap.clientWidth - inner.offsetWidth;
			}
			vX = -vX;
		}
		if(innerTop < 0 || innerBottom > wrap.clientHeight){

			// 判断碰到上边壁
			if(vY < 0){
				innerT = 0;
			}else if(vY > 0){
				innerT = wrap.clientHeight - inner.offsetHeight;
			}
			vY = -vY;
		}
		inner.style.left = innerL + "px";
		inner.style.top = innerT + "px";
	},50);

</script>
</html>